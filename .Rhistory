example_data$text<-as.character(quanteda.textmodels::data_corpus_moviereviews)
example_data$label[c(1:500,1001:1750)]=NA
example_targets<-as.factor(example_data$label)
names(example_targets)=example_data$id
test_classifier2<-TextEmbeddingClassifierNeuralNet$new(
name="Test",
label="abc",
text_embeddings=bert_embeddings,
#text_embeddings=embeddings,
targets=example_targets,
#targets=debug_targets,
config=list(
hidden=NULL,
gru=c(64),
dropout=0.2,
l2_regularizer=0.001,
recurrent_dropout=0.4,
optimizer="adam",
act_fct="sigmoid",
act_fct_last="softmax",
err_fct="CategoricalCrossentropy")
)
Q
Q
bert_embeddings
#-------------------------------------------------------------------------------
devtools::load_all()
example_data<-data.frame(
id=quanteda::docvars(quanteda.textmodels::data_corpus_moviereviews)$id2,
label=quanteda::docvars(quanteda.textmodels::data_corpus_moviereviews)$sentiment)
example_data$text<-as.character(quanteda.textmodels::data_corpus_moviereviews)
example_data$label[c(1:500,1001:1750)]=NA
example_targets<-as.factor(example_data$label)
names(example_targets)=example_data$id
#-------------------------------------------------------------------------------
devtools::load_all()
test_classifier2<-TextEmbeddingClassifierNeuralNet$new(
name="Test",
label="abc",
text_embeddings=bert_embeddings,
#text_embeddings=embeddings,
targets=example_targets,
#targets=debug_targets,
config=list(
hidden=NULL,
gru=c(64),
dropout=0.2,
l2_regularizer=0.001,
recurrent_dropout=0.4,
optimizer="adam",
act_fct="sigmoid",
act_fct_last="softmax",
err_fct="CategoricalCrossentropy")
)
#-------------------------------------------------------------------------------
devtools::load_all()
test_classifier2<-TextEmbeddingClassifierNeuralNet$new(
name="Test",
label="abc",
text_embeddings=bert_embeddings,
#text_embeddings=embeddings,
targets=example_targets,
#targets=debug_targets,
config=list(
hidden=NULL,
gru=c(64),
dropout=0.2,
l2_regularizer=0.001,
recurrent_dropout=0.4,
optimizer="adam",
act_fct="sigmoid",
act_fct_last="softmax",
err_fct="CategoricalCrossentropy")
)
config$hidden
#-------------------------------------------------------------------------------
devtools::load_all()
test_classifier2<-TextEmbeddingClassifierNeuralNet$new(
name="Test",
label="abc",
text_embeddings=bert_embeddings,
#text_embeddings=embeddings,
targets=example_targets,
#targets=debug_targets,
config=list(
hidden=NULL,
gru=c(64),
dropout=0.2,
l2_regularizer=0.001,
recurrent_dropout=0.4,
optimizer="adam",
act_fct="sigmoid",
act_fct_last="softmax",
err_fct="CategoricalCrossentropy")
)
test_classifier2<-TextEmbeddingClassifierNeuralNet$new(
name="Test",
label="abc",
text_embeddings=bert_embeddings,
#text_embeddings=embeddings,
targets=example_targets,
#targets=debug_targets,
config=list(
hidden=NULL,
gru=c(64),
dropout=0.2,
l2_regularizer=0.001,
recurrent_dropout=0.4,
optimizer="adam",
act_fct="sigmoid",
rec_act_fct="tanh")
)
test<-bundle::unbundle(test_classifier2$bundeled_model)
summary(test)
test_classifier2<-TextEmbeddingClassifierNeuralNet$new(
name="Test",
label="abc",
text_embeddings=bert_embeddings,
#text_embeddings=embeddings,
targets=example_targets,
#targets=debug_targets,
config=list(
hidden=NULL,
gru=c(64),
dropout=0.2,
l2_regularizer=0.001,
recurrent_dropout=0.4,
optimizer="adam",
act_fct="sigmoid",
rec_act_fct="tanh")
)
test<-bundle::unbundle(test_classifier2$bundeled_model)
summary(test)
test_classifier2<-TextEmbeddingClassifierNeuralNet$new(
name="Test",
label="abc",
text_embeddings=bert_embeddings,
#text_embeddings=embeddings,
targets=example_targets,
#targets=debug_targets,
config=list(
hidden=NULL,
gru=c(64,64),
dropout=0.2,
l2_regularizer=0.001,
recurrent_dropout=0.4,
optimizer="adam",
act_fct="sigmoid",
rec_act_fct="tanh")
)
test<-bundle::unbundle(test_classifier2$bundeled_model)
summary(test)
set_config_tf_logger("WARN")
test_classifier2<-TextEmbeddingClassifierNeuralNet$new(
name="Test",
label="abc",
text_embeddings=bert_embeddings,
#text_embeddings=embeddings,
targets=example_targets,
#targets=debug_targets,
config=list(
hidden=NULL,
rec=c(64,64),
dropout=0.2,
l2_regularizer=0.001,
recurrent_dropout=0.4,
optimizer="adam",
act_fct="sigmoid",
rec_act_fct="tanh")
)
test<-bundle::unbundle(test_classifier2$bundeled_model)
summary(test)
devtools::document()
devtools::document()
pkgload::dev_help('TextEmbeddingClassifierNeuralNet')
devtools::load_all()
#-------------------------------------------------------------------------------
devtools::load_all()
test_classifier2<-TextEmbeddingClassifierNeuralNet$new(
name="Test",
label="abc",
text_embeddings=bert_embeddings,
#text_embeddings=embeddings,
targets=example_targets,
#targets=debug_targets,
hidden=NULL,
rec=c(64,64),
dropout=0.2,
l2_regularizer=0.001,
recurrent_dropout=0.4,
optimizer="adam",
act_fct="sigmoid",
rec_act_fct="tanh")
test<-bundle::unbundle(test_classifier2$bundeled_model)
summary(test)
test_classifier2$train(#data_embeddings=embeddings,
data_embeddings=bert_embeddings,
data_targets=example_targets,
#data_targets=debug_targets,
data_n_valid_samples=2,
use_baseline=TRUE,
bsl_val_size=0.25,
use_bsc=FALSE,
bsc_methods=c("dbsmote"),
bsc_max_k=5,
use_bpl=FALSE,
bpl_max_steps=5,
bpl_inc_ratio=0.75,
bpl_anchor=.90,
bpl_min=0.80,
bpl_valid_size=0.33,
epochs=15,
batch_size=32,
trace=TRUE,
keras_trace=1,
view_metrics=FALSE,
n_cores=3,
dir_checkpoint="Trial/checkpoints",
opt_model_reset=TRUE)
test_classifier2<-TextEmbeddingClassifierNeuralNet$new(
name="Test",
label="abc",
text_embeddings=bert_embeddings,
#text_embeddings=embeddings,
targets=example_targets,
#targets=debug_targets,
hidden=NULL,
rec=c(64,64),
dropout=0.2,
l2_regularizer=0.001,
recurrent_dropout=0.4,
optimizer="adam",
act_fct="sigmoid",
rec_act_fct="gelu")
test_classifier2$train(#data_embeddings=embeddings,
data_embeddings=bert_embeddings,
data_targets=example_targets,
#data_targets=debug_targets,
data_n_valid_samples=2,
use_baseline=TRUE,
bsl_val_size=0.25,
use_bsc=FALSE,
bsc_methods=c("dbsmote"),
bsc_max_k=5,
use_bpl=FALSE,
bpl_max_steps=5,
bpl_inc_ratio=0.75,
bpl_anchor=.90,
bpl_min=0.80,
bpl_valid_size=0.33,
epochs=15,
batch_size=32,
trace=TRUE,
keras_trace=1,
view_metrics=FALSE,
n_cores=3,
dir_checkpoint="Trial/checkpoints",
opt_model_reset=TRUE)
test_classifier2<-TextEmbeddingClassifierNeuralNet$new(
name="Test",
label="abc",
text_embeddings=bert_embeddings,
#text_embeddings=embeddings,
targets=example_targets,
#targets=debug_targets,
hidden=NULL,
rec=c(64,64),
dropout=0.2,
l2_regularizer=0.001,
recurrent_dropout=0.4,
optimizer="adam",
act_fct="tanh",
rec_act_fct="tanh")
test_classifier2$train(#data_embeddings=embeddings,
data_embeddings=bert_embeddings,
data_targets=example_targets,
#data_targets=debug_targets,
data_n_valid_samples=2,
use_baseline=TRUE,
bsl_val_size=0.25,
use_bsc=FALSE,
bsc_methods=c("dbsmote"),
bsc_max_k=5,
use_bpl=FALSE,
bpl_max_steps=5,
bpl_inc_ratio=0.75,
bpl_anchor=.90,
bpl_min=0.80,
bpl_valid_size=0.33,
epochs=15,
batch_size=32,
trace=TRUE,
keras_trace=1,
view_metrics=FALSE,
n_cores=3,
dir_checkpoint="Trial/checkpoints",
opt_model_reset=TRUE)
#-------------------------------------------------------------------------------
devtools::load_all()
example_data<-data.frame(
id=quanteda::docvars(quanteda.textmodels::data_corpus_moviereviews)$id2,
label=quanteda::docvars(quanteda.textmodels::data_corpus_moviereviews)$sentiment)
example_data$text<-as.character(quanteda.textmodels::data_corpus_moviereviews)
example_data$label[c(1:500,1001:1750)]=NA
example_targets<-as.factor(example_data$label)
names(example_targets)=example_data$id
table(example_targets)
test_classifier2<-TextEmbeddingClassifierNeuralNet$new(
name="Test",
label="abc",
text_embeddings=bert_embeddings,
#text_embeddings=embeddings_edda_base,
targets=example_targets,
#targets=debug_targets,
hidden=c(128,64),
rec=NULL,
dropout=0.2,
l2_regularizer=0.001,
recurrent_dropout=0.4,
optimizer="adam",
act_fct="gelu",
rec_act_fct="tanh")
test<-bundle::unbundle(test_classifier2$bundeled_model)
summary(test)
#set_config_tf_logger("WARN")
#tf$autograph$set_verbosity(0)
test_classifier2$train(#data_embeddings=embeddings_edda_base,
data_embeddings=bert_embeddings,
data_targets=example_targets,
#data_targets=debug_targets,
data_n_valid_samples=2,
use_baseline=TRUE,
bsl_val_size=0.25,
use_bsc=FALSE,
bsc_methods=c("dbsmote"),
bsc_max_k=5,
use_bpl=TRUE,
bpl_max_steps=5,
bpl_inc_ratio=.50,
bpl_anchor=.90,
bpl_min=0.80,
bpl_min_weight = .00,
bpl_valid_size=0.33,
epochs=15,
batch_size=32,
trace=TRUE,
keras_trace=1,
view_metrics=FALSE,
n_cores=3,
dir_checkpoint="Trial/checkpoints",
opt_model_reset=FALSE)
test_classifier2$reliability$val_metric_mean
#set_config_tf_logger("WARN")
#tf$autograph$set_verbosity(0)
test_classifier2$train(#data_embeddings=embeddings_edda_base,
data_embeddings=bert_embeddings,
data_targets=example_targets,
#data_targets=debug_targets,
data_n_valid_samples=2,
use_baseline=TRUE,
bsl_val_size=0.25,
use_bsc=FALSE,
bsc_methods=c("dbsmote"),
bsc_max_k=5,
use_bpl=TRUE,
bpl_max_steps=5,
bpl_inc_ratio=.50,
bpl_anchor=.90,
bpl_min=0.80,
bpl_min_weight = .50,
bpl_valid_size=0.33,
epochs=15,
batch_size=32,
trace=TRUE,
keras_trace=1,
view_metrics=FALSE,
n_cores=3,
dir_checkpoint="Trial/checkpoints",
opt_model_reset=FALSE)
test_classifier2$reliability$val_metric_mean
#-------------------------------------------------------------------------------
devtools::load_all()
example_data<-data.frame(
id=quanteda::docvars(quanteda.textmodels::data_corpus_moviereviews)$id2,
label=quanteda::docvars(quanteda.textmodels::data_corpus_moviereviews)$sentiment)
example_data$text<-as.character(quanteda.textmodels::data_corpus_moviereviews)
example_data$label[c(1:500,1001:1750)]=NA
example_targets<-as.factor(example_data$label)
names(example_targets)=example_data$id
table(example_targets)
test_classifier2<-TextEmbeddingClassifierNeuralNet$new(
name="Test",
label="abc",
text_embeddings=bert_embeddings,
#text_embeddings=embeddings_edda_base,
targets=example_targets,
#targets=debug_targets,
hidden=c(128,64),
rec=NULL,
dropout=0.2,
l2_regularizer=0.001,
recurrent_dropout=0.4,
optimizer="adam",
act_fct="gelu",
rec_act_fct="tanh")
test<-bundle::unbundle(test_classifier2$bundeled_model)
summary(test)
#set_config_tf_logger("WARN")
#tf$autograph$set_verbosity(0)
test_classifier2$train(#data_embeddings=embeddings_edda_base,
data_embeddings=bert_embeddings,
data_targets=example_targets,
#data_targets=debug_targets,
data_n_valid_samples=2,
use_baseline=TRUE,
bsl_val_size=0.25,
use_bsc=FALSE,
bsc_methods=c("dbsmote"),
bsc_max_k=5,
use_bpl=TRUE,
bpl_max_steps=5,
bpl_inc_ratio=.50,
bpl_anchor=.90,
bpl_min=0.80,
bpl_min_weight = .50,
bpl_valid_size = 0.33,
epochs=15,
batch_size=32,
trace=TRUE,
keras_trace=1,
view_metrics=FALSE,
n_cores=3,
dir_checkpoint="Trial/checkpoints",
opt_model_reset=FALSE)
#set_config_tf_logger("WARN")
#tf$autograph$set_verbosity(0)
test_classifier2$train(#data_embeddings=embeddings_edda_base,
data_embeddings=bert_embeddings,
data_targets=example_targets,
#data_targets=debug_targets,
data_n_valid_samples=2,
use_baseline=TRUE,
bsl_val_size=0.25,
use_bsc=FALSE,
bsc_methods=c("dbsmote"),
bsc_max_k=5,
use_bpl=TRUE,
bpl_max_steps=5,
bpl_inc_ratio=.50,
bpl_anchor=.90,
bpl_valid_size = 0.33,
epochs=15,
batch_size=32,
trace=TRUE,
keras_trace=1,
view_metrics=FALSE,
n_cores=3,
dir_checkpoint="Trial/checkpoints",
opt_model_reset=FALSE)
#-------------------------------------------------------------------------------
devtools::load_all()
example_data<-data.frame(
id=quanteda::docvars(quanteda.textmodels::data_corpus_moviereviews)$id2,
label=quanteda::docvars(quanteda.textmodels::data_corpus_moviereviews)$sentiment)
example_data$text<-as.character(quanteda.textmodels::data_corpus_moviereviews)
example_data$label[c(1:500,1001:1750)]=NA
example_targets<-as.factor(example_data$label)
names(example_targets)=example_data$id
table(example_targets)
test_classifier2<-TextEmbeddingClassifierNeuralNet$new(
name="Test",
label="abc",
text_embeddings=bert_embeddings,
#text_embeddings=embeddings_edda_base,
targets=example_targets,
#targets=debug_targets,
hidden=c(128,64),
rec=NULL,
dropout=0.2,
l2_regularizer=0.001,
recurrent_dropout=0.4,
optimizer="adam",
act_fct="gelu",
rec_act_fct="tanh")
test<-bundle::unbundle(test_classifier2$bundeled_model)
summary(test)
#set_config_tf_logger("WARN")
#tf$autograph$set_verbosity(0)
test_classifier2$train(#data_embeddings=embeddings_edda_base,
data_embeddings=bert_embeddings,
data_targets=example_targets,
#data_targets=debug_targets,
data_n_valid_samples=2,
use_baseline=TRUE,
bsl_val_size=0.25,
use_bsc=FALSE,
bsc_methods=c("dbsmote"),
bsc_max_k=5,
use_bpl=TRUE,
bpl_max_steps=5,
bpl_inc_ratio=.50,
bpl_anchor=.90,
bpl_valid_size = 0.33,
epochs=15,
batch_size=32,
trace=TRUE,
keras_trace=1,
view_metrics=FALSE,
n_cores=3,
dir_checkpoint="Trial/checkpoints",
opt_model_reset=FALSE)
test_classifier2$reliability$val_metric_mean
