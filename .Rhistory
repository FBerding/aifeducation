bpl_min=0.80,
bpl_min_weight = .00,
bpl_valid_size=0.33,
epochs=15,
batch_size=32,
trace=TRUE,
keras_trace=1,
view_metrics=FALSE,
n_cores=3,
dir_checkpoint="Trial/checkpoints",
opt_model_reset=FALSE)
test_classifier2$reliability$val_metric_mean
#set_config_tf_logger("WARN")
#tf$autograph$set_verbosity(0)
test_classifier2$train(#data_embeddings=embeddings_edda_base,
data_embeddings=bert_embeddings,
data_targets=example_targets,
#data_targets=debug_targets,
data_n_valid_samples=2,
use_baseline=TRUE,
bsl_val_size=0.25,
use_bsc=FALSE,
bsc_methods=c("dbsmote"),
bsc_max_k=5,
use_bpl=TRUE,
bpl_max_steps=5,
bpl_inc_ratio=.50,
bpl_anchor=.90,
bpl_min=0.80,
bpl_min_weight = .50,
bpl_valid_size=0.33,
epochs=15,
batch_size=32,
trace=TRUE,
keras_trace=1,
view_metrics=FALSE,
n_cores=3,
dir_checkpoint="Trial/checkpoints",
opt_model_reset=FALSE)
test_classifier2$reliability$val_metric_mean
#-------------------------------------------------------------------------------
devtools::load_all()
example_data<-data.frame(
id=quanteda::docvars(quanteda.textmodels::data_corpus_moviereviews)$id2,
label=quanteda::docvars(quanteda.textmodels::data_corpus_moviereviews)$sentiment)
example_data$text<-as.character(quanteda.textmodels::data_corpus_moviereviews)
example_data$label[c(1:500,1001:1750)]=NA
example_targets<-as.factor(example_data$label)
names(example_targets)=example_data$id
table(example_targets)
test_classifier2<-TextEmbeddingClassifierNeuralNet$new(
name="Test",
label="abc",
text_embeddings=bert_embeddings,
#text_embeddings=embeddings_edda_base,
targets=example_targets,
#targets=debug_targets,
hidden=c(128,64),
rec=NULL,
dropout=0.2,
l2_regularizer=0.001,
recurrent_dropout=0.4,
optimizer="adam",
act_fct="gelu",
rec_act_fct="tanh")
test<-bundle::unbundle(test_classifier2$bundeled_model)
summary(test)
#set_config_tf_logger("WARN")
#tf$autograph$set_verbosity(0)
test_classifier2$train(#data_embeddings=embeddings_edda_base,
data_embeddings=bert_embeddings,
data_targets=example_targets,
#data_targets=debug_targets,
data_n_valid_samples=2,
use_baseline=TRUE,
bsl_val_size=0.25,
use_bsc=FALSE,
bsc_methods=c("dbsmote"),
bsc_max_k=5,
use_bpl=TRUE,
bpl_max_steps=5,
bpl_inc_ratio=.50,
bpl_anchor=.90,
bpl_min=0.80,
bpl_min_weight = .50,
bpl_valid_size = 0.33,
epochs=15,
batch_size=32,
trace=TRUE,
keras_trace=1,
view_metrics=FALSE,
n_cores=3,
dir_checkpoint="Trial/checkpoints",
opt_model_reset=FALSE)
#set_config_tf_logger("WARN")
#tf$autograph$set_verbosity(0)
test_classifier2$train(#data_embeddings=embeddings_edda_base,
data_embeddings=bert_embeddings,
data_targets=example_targets,
#data_targets=debug_targets,
data_n_valid_samples=2,
use_baseline=TRUE,
bsl_val_size=0.25,
use_bsc=FALSE,
bsc_methods=c("dbsmote"),
bsc_max_k=5,
use_bpl=TRUE,
bpl_max_steps=5,
bpl_inc_ratio=.50,
bpl_anchor=.90,
bpl_valid_size = 0.33,
epochs=15,
batch_size=32,
trace=TRUE,
keras_trace=1,
view_metrics=FALSE,
n_cores=3,
dir_checkpoint="Trial/checkpoints",
opt_model_reset=FALSE)
#-------------------------------------------------------------------------------
devtools::load_all()
example_data<-data.frame(
id=quanteda::docvars(quanteda.textmodels::data_corpus_moviereviews)$id2,
label=quanteda::docvars(quanteda.textmodels::data_corpus_moviereviews)$sentiment)
example_data$text<-as.character(quanteda.textmodels::data_corpus_moviereviews)
example_data$label[c(1:500,1001:1750)]=NA
example_targets<-as.factor(example_data$label)
names(example_targets)=example_data$id
table(example_targets)
test_classifier2<-TextEmbeddingClassifierNeuralNet$new(
name="Test",
label="abc",
text_embeddings=bert_embeddings,
#text_embeddings=embeddings_edda_base,
targets=example_targets,
#targets=debug_targets,
hidden=c(128,64),
rec=NULL,
dropout=0.2,
l2_regularizer=0.001,
recurrent_dropout=0.4,
optimizer="adam",
act_fct="gelu",
rec_act_fct="tanh")
test<-bundle::unbundle(test_classifier2$bundeled_model)
summary(test)
#set_config_tf_logger("WARN")
#tf$autograph$set_verbosity(0)
test_classifier2$train(#data_embeddings=embeddings_edda_base,
data_embeddings=bert_embeddings,
data_targets=example_targets,
#data_targets=debug_targets,
data_n_valid_samples=2,
use_baseline=TRUE,
bsl_val_size=0.25,
use_bsc=FALSE,
bsc_methods=c("dbsmote"),
bsc_max_k=5,
use_bpl=TRUE,
bpl_max_steps=5,
bpl_inc_ratio=.50,
bpl_anchor=.90,
bpl_valid_size = 0.33,
epochs=15,
batch_size=32,
trace=TRUE,
keras_trace=1,
view_metrics=FALSE,
n_cores=3,
dir_checkpoint="Trial/checkpoints",
opt_model_reset=FALSE)
test_classifier2$reliability$val_metric_mean
#-------------------------------------------------------------------------------
devtools::load_all()
example_data<-data.frame(
id=quanteda::docvars(quanteda.textmodels::data_corpus_moviereviews)$id2,
label=quanteda::docvars(quanteda.textmodels::data_corpus_moviereviews)$sentiment)
example_data$text<-as.character(quanteda.textmodels::data_corpus_moviereviews)
example_data$label[c(1:500,1001:1750)]=NA
example_targets<-as.factor(example_data$label)
names(example_targets)=example_data$id
table(example_targets)
test_classifier2<-TextEmbeddingClassifierNeuralNet$new(
name="Test",
label="abc",
text_embeddings=bert_embeddings,
#text_embeddings=embeddings_edda_base,
targets=example_targets,
#targets=debug_targets,
hidden=c(128,64),
rec=NULL,
dropout=0.2,
l2_regularizer=0.001,
recurrent_dropout=0.4,
optimizer="adam",
act_fct="gelu",
rec_act_fct="tanh")
test<-bundle::unbundle(test_classifier2$bundeled_model)
summary(test)
#set_config_tf_logger("WARN")
#tf$autograph$set_verbosity(0)
test_classifier2$train(#data_embeddings=embeddings_edda_base,
data_embeddings=bert_embeddings,
data_targets=example_targets,
#data_targets=debug_targets,
data_n_valid_samples=2,
use_baseline=TRUE,
bsl_val_size=0.25,
use_bsc=FALSE,
bsc_methods=c("dbsmote"),
bsc_max_k=5,
use_bpl=TRUE,
bpl_max_steps=5,
bpl_inc_ratio=.50,
bpl_anchor=.90,
bpl_min=0.80,
bpl_valid_size = 0.33,
epochs=15,
batch_size=32,
trace=TRUE,
keras_trace=1,
view_metrics=FALSE,
n_cores=3,
dir_checkpoint="Trial/checkpoints",
opt_model_reset=FALSE)
#-------------------------------------------------------------------------------
devtools::load_all()
example_data<-data.frame(
id=quanteda::docvars(quanteda.textmodels::data_corpus_moviereviews)$id2,
label=quanteda::docvars(quanteda.textmodels::data_corpus_moviereviews)$sentiment)
example_data$text<-as.character(quanteda.textmodels::data_corpus_moviereviews)
example_data$label[c(1:500,1001:1750)]=NA
example_targets<-as.factor(example_data$label)
names(example_targets)=example_data$id
table(example_targets)
test_classifier2<-TextEmbeddingClassifierNeuralNet$new(
name="Test",
label="abc",
text_embeddings=bert_embeddings,
#text_embeddings=embeddings_edda_base,
targets=example_targets,
#targets=debug_targets,
hidden=c(128,64),
rec=NULL,
dropout=0.2,
l2_regularizer=0.001,
recurrent_dropout=0.4,
optimizer="adam",
act_fct="gelu",
rec_act_fct="tanh")
test<-bundle::unbundle(test_classifier2$bundeled_model)
summary(test)
#set_config_tf_logger("WARN")
#tf$autograph$set_verbosity(0)
test_classifier2$train(#data_embeddings=embeddings_edda_base,
data_embeddings=bert_embeddings,
data_targets=example_targets,
#data_targets=debug_targets,
data_n_valid_samples=2,
use_baseline=TRUE,
bsl_val_size=0.25,
use_bsc=FALSE,
bsc_methods=c("dbsmote"),
bsc_max_k=5,
use_bpl=TRUE,
bpl_max_steps=5,
bpl_inc_ratio=.50,
bpl_anchor=.90,
bpl_min=0.80,
bpl_valid_size = 0.33,
epochs=15,
batch_size=32,
trace=TRUE,
keras_trace=1,
view_metrics=FALSE,
n_cores=3,
dir_checkpoint="Trial/checkpoints",
opt_model_reset=FALSE)
#-------------------------------------------------------------------------------
devtools::load_all()
example_data<-data.frame(
id=quanteda::docvars(quanteda.textmodels::data_corpus_moviereviews)$id2,
label=quanteda::docvars(quanteda.textmodels::data_corpus_moviereviews)$sentiment)
example_data$text<-as.character(quanteda.textmodels::data_corpus_moviereviews)
example_data$label[c(1:500,1001:1750)]=NA
example_targets<-as.factor(example_data$label)
names(example_targets)=example_data$id
table(example_targets)
test_classifier2<-TextEmbeddingClassifierNeuralNet$new(
name="Test",
label="abc",
text_embeddings=bert_embeddings,
#text_embeddings=embeddings_edda_base,
targets=example_targets,
#targets=debug_targets,
hidden=c(128,64),
rec=NULL,
dropout=0.2,
l2_regularizer=0.001,
recurrent_dropout=0.4,
optimizer="adam",
act_fct="gelu",
rec_act_fct="tanh")
test<-bundle::unbundle(test_classifier2$bundeled_model)
summary(test)
#set_config_tf_logger("WARN")
#tf$autograph$set_verbosity(0)
test_classifier2$train(#data_embeddings=embeddings_edda_base,
data_embeddings=bert_embeddings,
data_targets=example_targets,
#data_targets=debug_targets,
data_n_valid_samples=2,
use_baseline=TRUE,
bsl_val_size=0.25,
use_bsc=FALSE,
bsc_methods=c("dbsmote"),
bsc_max_k=5,
use_bpl=TRUE,
bpl_max_steps=5,
bpl_inc_ratio=.50,
bpl_anchor=.90,
bpl_min=0.80,
bpl_valid_size = 0.33,
epochs=15,
batch_size=32,
trace=TRUE,
keras_trace=1,
view_metrics=FALSE,
n_cores=3,
dir_checkpoint="Trial/checkpoints",
opt_model_reset=FALSE)
test_classifier2$reliability$val_metric_mean
devtools::document()
#-------------------------------------------------------------------------------
devtools::load_all()
example_data<-data.frame(
id=quanteda::docvars(quanteda.textmodels::data_corpus_moviereviews)$id2,
label=quanteda::docvars(quanteda.textmodels::data_corpus_moviereviews)$sentiment)
example_data$text<-as.character(quanteda.textmodels::data_corpus_moviereviews)
example_data$label[c(1:500,1001:1750)]=NA
example_targets<-as.factor(example_data$label)
names(example_targets)=example_data$id
table(example_targets)
test_classifier2<-TextEmbeddingClassifierNeuralNet$new(
name="Test",
label="abc",
text_embeddings=bert_embeddings,
#text_embeddings=embeddings_edda_base,
targets=example_targets,
#targets=debug_targets,
hidden=c(128,64),
rec=NULL,
dropout=0.2,
l2_regularizer=0.001,
recurrent_dropout=0.4,
optimizer="adam",
act_fct="gelu",
rec_act_fct="tanh")
test<-bundle::unbundle(test_classifier2$bundeled_model)
summary(test)
#set_config_tf_logger("WARN")
#tf$autograph$set_verbosity(0)
test_classifier2$train(#data_embeddings=embeddings_edda_base,
data_embeddings=bert_embeddings,
data_targets=example_targets,
#data_targets=debug_targets,
data_n_valid_samples=2,
use_baseline=TRUE,
bsl_val_size=0.25,
use_bsc=TRUE,
bsc_methods=c("dbsmote"),
bsc_max_k=5,
use_bpl=TRUE,
bpl_max_steps=2,
bpl_inc_ratio=.50,
bpl_anchor=.90,
bpl_min=0.80,
bpl_valid_size = 0.33,
epochs=15,
batch_size=32,
trace=TRUE,
keras_trace=1,
view_metrics=FALSE,
n_cores=3,
dir_checkpoint="Trial/checkpoints",
bpl_model_reset=FALSE)
test_classifier2$reliability$test_metric_mean
devtools::build()
source("C:/Users/WissMit/Desktop/Forschung Hamburg/KI und Unterrichtsentwuerfe/Trainingscenter/Daten_KI_Training/Daten_Zusammenführung.R", echo=TRUE)
library(keras)
#-------------------------------------------------------------------------------
devtools::load_all()
example_data<-data.frame(
id=quanteda::docvars(quanteda.textmodels::data_corpus_moviereviews)$id2,
label=quanteda::docvars(quanteda.textmodels::data_corpus_moviereviews)$sentiment)
example_data$text<-as.character(quanteda.textmodels::data_corpus_moviereviews)
example_data$label[c(1:500,1001:1750)]=NA
example_targets<-as.factor(example_data$label)
names(example_targets)=example_data$id
table(example_targets)
test_classifier2<-TextEmbeddingClassifierNeuralNet$new(
name="Test",
label="abc",
text_embeddings=bert_embeddings,
#text_embeddings=embeddings_edda_base,
targets=example_targets,
#targets=debug_targets,
hidden=NULL,
rec=c(128,64),
self_attention_heads = 0,
dropout=0.2,
l2_regularizer=0.001,
recurrent_dropout=0.4,
optimizer="adam",
act_fct="gelu",
rec_act_fct="tanh")
#-------------------------------------------------------------------------------
devtools::load_all()
test_classifier2<-TextEmbeddingClassifierNeuralNet$new(
name="Test",
label="abc",
text_embeddings=bert_embeddings,
#text_embeddings=embeddings_edda_base,
targets=example_targets,
#targets=debug_targets,
hidden=NULL,
rec=c(128,64),
self_attention_heads = 0,
dropout=0.2,
l2_regularizer=0.001,
recurrent_dropout=0.4,
optimizer="adam",
act_fct="gelu",
rec_act_fct="tanh")
test<-bundle::unbundle(test_classifier2$bundeled_model)
summary(test)
bert_embeddings
test_classifier2<-TextEmbeddingClassifierNeuralNet$new(
name="Test",
label="abc",
text_embeddings=bert_embeddings,
#text_embeddings=embeddings_edda_base,
targets=example_targets,
#targets=debug_targets,
hidden=NULL,
rec=c(128,64),
self_attention_heads = 2,
dropout=0.2,
l2_regularizer=0.001,
recurrent_dropout=0.4,
optimizer="adam",
act_fct="gelu",
rec_act_fct="tanh")
test<-bundle::unbundle(test_classifier2$bundeled_model)
summary(test)
#set_config_tf_logger("WARN")
#tf$autograph$set_verbosity(0)
test_classifier2$train(#data_embeddings=embeddings_edda_base,
data_embeddings=bert_embeddings,
data_targets=example_targets,
#data_targets=debug_targets,
data_n_valid_samples=2,
use_baseline=TRUE,
bsl_val_size=0.25,
use_bsc=TRUE,
bsc_methods=c("dbsmote"),
bsc_max_k=5,
use_bpl=TRUE,
bpl_max_steps=2,
bpl_inc_ratio=.75,
bpl_anchor=.90,
bpl_min=0.75,
bpl_valid_size = 0.33,
epochs=15,
batch_size=32,
trace=TRUE,
keras_trace=1,
view_metrics=FALSE,
n_cores=3,
dir_checkpoint="Trial/checkpoints",
bpl_model_reset=FALSE)
usethis::use_vignette(name="sharing_and_publishing",title = "Sharing and Using Trained AI/Models")
test_classifier2$text_embedding_model
devtools::document()
devtools::build_site()
devtools::build_site()
devtools::test()
testthat::skip_if_not(condition=check_aif_py_modules(),
message  = "Necessary python modules not available")
testthat::skip_if_not(condition=check_aif_py_modules(),
message  = "Necessary python modules not available")
#-------------------------------------------------------------------------------
example_data<-data.frame(
id=quanteda::docvars(quanteda.textmodels::data_corpus_moviereviews)$id2,
label=quanteda::docvars(quanteda.textmodels::data_corpus_moviereviews)$sentiment)
example_data$text<-as.character(quanteda.textmodels::data_corpus_moviereviews)
example_data$label[c(1:500,1001:1750)]=NA
example_targets<-as.factor(example_data$label)
names(example_targets)=example_data$id
current_embeddings<-bert_embeddings$clone(deep = TRUE)
devtools::test()
test_classifier2$reliability$test_metric
test_classifier2$reliability$test_metric_mean
test_classifier2$text_embedding_model
devtools::load_all()
devtools::build()
devtools::load_all()
tf
tf$keras$backend$clear_session()
devtools::document()
devtools::document()
devtools::build()
